app.controller("EbooksChapterPostCtrl",["$route","$log","$filter","myAppURLs","JsonDataService","EncodeService","httpCall","$sanitize","$sce",function(e,t,o,s,n,c,i,a,r){var u=this,l=n.GetJsonInfo(e.current.templateUrl);i.GetMethod(l).then(function(e){u.JsonVals=e},function(e){console.log(e.statusText),t.info(e)}),u.BtnShow=!0;var p=JSON.parse(c.encodelogval(sessionStorage.UserInfo));u.urid=p.UserRightsId,u.reload=function(){u.ebookpostch=[],u.isClicked=!1,u.BtnShow=!0,u.successmessage="",u.showmee=!1,u.ebookpostch.category_id="",u.ebookpostch.chapter_name="",u.ebookpostch.alias_url="",u.ebookpostch.sequence_no="",u.ebookpostch.chapter_id="",u.ebookpostch.flag=""},u.getIQList=function(){var e=s.GetEbookChapterList,o=new Object;o.category_id="0",o.chapter_id="0",i.PostMethod(e,o).then(function(e){u.bookslists=e,console.log(u.bookslists),u.selection=[],u.buttonnavi=!0,u.successmessage=""},function(e){console.log(e.statusText),t.err(e)})},u.getIQList(),u.to_trusted=function(e){return r.trustAsHtml(e)};var h=s.fetchcategory,d=new Object;d.parent_menu_id="6",i.PostMethod(h,d).then(function(e){u.cLists=e.fetchcategoryResult},function(e){console.log(e.statusText),t.err(e)}),u.copyText=function(e){u.ebookpostch.alias_url=o("lowercase")(e).replace(/ +(?=)/g,"-")},u.selectedItemChanged=function(e){function t(e,t){return e.filter(function(e){return Object.keys(t).every(function(o){return e[o]==t[o]})})}var o=t(JSON.parse(JSON.stringify(u.bookslists)),{category_id:e});o.length>0?u.ebookpostch.sequence_no=o[0].sequence_no+1:u.ebookpostch.sequence_no=1},u.successmessage="",u.submit_btn=!0,u.selection=[],u.MultipleSelection=function(e){var t=u.selection.indexOf(e);"0"==t&&(u.buttonnavi=!0),t>-1?u.selection.splice(t,1):(u.selection.push(e),u.buttonnavi=!1)},u.changestatus=function(e){var t=[];t.category_id="0",t.chapter_name="",t.alias_url="",t.sequence_no="0",t.chapter_id=u.selection.toString(),u.ebookchapterpost(t,e)},u.update_iq_info=function(e,t){$(".seqnum").prop("disabled",!1),u.isClicked=!1,u.BtnShow=!1,u.showmee=!0,u.successmessage="",u.ebookpostch=angular.copy(e)},u.ebookchapterpost=function(e,o){var n=new Object,c=s.PostBookChapter,a=s.UpdateBookChapter;n.UserId=p.UserId,n.category_id=e.category_id,n.chapter_name=e.chapter_name,n.alias_url=e.alias_url,n.sequence_no=e.sequence_no,o?(n.chapter_id=e.chapter_id,n.flag=o,i.PostMethod(a,n).then(function(e){u.successmessage=e,u.isClicked=!0,$rootScope.demoroute(),$rootScope.update(),u.getIQList()},function(e){console.log(e.statusText),t.info(e)})):i.PostMethod(c,n).then(function(e){var t=e.split(",");u.successmessage=t[0],u.isClicked=!0,u.getIQList()},function(e){console.log(e.statusText),t.info(e)})}}]);
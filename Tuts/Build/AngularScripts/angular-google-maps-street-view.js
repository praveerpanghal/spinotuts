!function(e,n,i){"use strict";(function(){n.module("uiGmapgoogle-maps.providers",["nemLogging"]),n.module("uiGmapgoogle-maps.wrapped",[]),n.module("uiGmapgoogle-maps.extensions",["uiGmapgoogle-maps.wrapped","uiGmapgoogle-maps.providers"]),n.module("uiGmapgoogle-maps.directives.api.utils",["uiGmapgoogle-maps.extensions"]),n.module("uiGmapgoogle-maps.directives.api.managers",[]),n.module("uiGmapgoogle-maps.directives.api.options",["uiGmapgoogle-maps.directives.api.utils"]),n.module("uiGmapgoogle-maps.directives.api.options.builders",[]),n.module("uiGmapgoogle-maps.directives.api.models.child",["uiGmapgoogle-maps.directives.api.utils","uiGmapgoogle-maps.directives.api.options","uiGmapgoogle-maps.directives.api.options.builders"]),n.module("uiGmapgoogle-maps.directives.api.models.parent",["uiGmapgoogle-maps.directives.api.managers","uiGmapgoogle-maps.directives.api.models.child","uiGmapgoogle-maps.providers"]),n.module("uiGmapgoogle-maps.directives.api",["uiGmapgoogle-maps.directives.api.models.parent"]),n.module("uiGmapgoogle-maps",["uiGmapgoogle-maps.directives.api","uiGmapgoogle-maps.providers"])}).call(this),n.module("uiGmapgoogle-maps.wrapped").service("uiGmapuuid",function(){function e(){}return e.generate=function(){var n=e._gri,i=e._ha;return i(n(32),8)+"-"+i(n(16),4)+"-"+i(16384|n(12),4)+"-"+i(32768|n(14),4)+"-"+i(n(48),12)},e._gri=function(e){return 0>e?NaN:30>=e?0|Math.random()*(1<<e):53>=e?(0|1073741824*Math.random())+1073741824*(0|Math.random()*(1<<e-30)):NaN},e._ha=function(e,n){for(var i=e.toString(16),o=n-i.length,t="0";0<o;o>>>=1,t+=t)1&o&&(i=t+i);return i},e}),function(){n.module("uiGmapgoogle-maps.providers").factory("uiGmapMapScriptLoader",["$q","uiGmapuuid",function(i,o){var t,r,a,u,s;return u=void 0,s=void 0,t=function(e){return e.china?"http://maps.google.cn/maps/api/js?":"auto"===e.transport?"//maps.googleapis.com/maps/api/js?":e.transport+"://maps.googleapis.com/maps/api/js?"},r=function(e){var n,i,r,a;return n=["transport","isGoogleMapsForWork","china","preventLoad"],e.isGoogleMapsForWork&&n.push("key"),i=_.map(_.omit(e,n),function(e,n){return n+"="+e}),u&&(a=document.getElementById(u),a.parentNode.removeChild(a)),i=i.join("&"),r=document.createElement("script"),r.id=u="ui_gmap_map_load_"+o.generate(),r.type="text/javascript",r.src=t(e)+i,document.body.appendChild(r)},a=function(){return n.isDefined(e.google)&&n.isDefined(e.google.maps)},{load:function(n){var o,t;return o=i.defer(),a()?(o.resolve(e.google.maps),o.promise):(t=n.callback="onGoogleMapsReady"+Math.round(1e3*Math.random()),e[t]=function(){e[t]=null,o.resolve(e.google.maps)},e.navigator.connection&&e.Connection&&e.navigator.connection.type===e.Connection.NONE&&!n.preventLoad?document.addEventListener("online",function(){if(!a())return r(n)}):n.preventLoad||r(n),s=n,s.randomizedFunctionName=t,o.promise)},manualLoad:function(){var n;return n=s,a()?e[n.randomizedFunctionName]?e[n.randomizedFunctionName]():void 0:r(n)}}}]).provider("uiGmapGoogleMapApi",function(){return this.options={transport:"https",isGoogleMapsForWork:!1,china:!1,v:"3",libraries:"",language:"en",preventLoad:!1},this.configure=function(e){n.extend(this.options,e)},this.$get=["uiGmapMapScriptLoader",function(e){return function(n){return n.load(e.options)}}(this)],this}).service("uiGmapGoogleMapApiManualLoader",["uiGmapMapScriptLoader",function(e){return{load:function(){e.manualLoad()}}}])}.call(this),function(){n.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapLogger",["nemSimpleLogger",function(e){return e.spawn()}])}.call(this),function(){n.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapGmapUtil",["uiGmapLogger","$compile",function(e,i){var o,t,r,a,u,s;return t=function(e,n,i){return e===n||i.indexOf(e)!==-1},o=function(e){return t(e,!1,["false","FALSE",0,"n","N","no","NO"])},a=function(e){return Array.isArray(e)&&2===e.length?e[1]:n.isDefined(e.type)&&"Point"===e.type?e.coordinates[1]:e.latitude},u=function(e){return Array.isArray(e)&&2===e.length?e[0]:n.isDefined(e.type)&&"Point"===e.type?e.coordinates[0]:e.longitude},r=function(e){if(e)return Array.isArray(e)&&2===e.length?new google.maps.LatLng(e[1],e[0]):n.isDefined(e.type)&&"Point"===e.type?new google.maps.LatLng(e.coordinates[1],e.coordinates[0]):new google.maps.LatLng(e.latitude,e.longitude)},s=function(e){if(n.isUndefined(e))return!1;if(_.isArray(e)){if(2===e.length)return!0}else if(null!=e&&(null!=e?e.type:void 0)&&"Point"===e.type&&_.isArray(e.coordinates)&&2===e.coordinates.length)return!0;return!(!e||!n.isDefined((null!=e?e.latitude:void 0)&&n.isDefined(null!=e?e.longitude:void 0)))},{setCoordsFromEvent:function(e,i){if(e)return Array.isArray(e)&&2===e.length?(e[1]=i.lat(),e[0]=i.lng()):n.isDefined(e.type)&&"Point"===e.type?(e.coordinates[1]=i.lat(),e.coordinates[0]=i.lng()):(e.latitude=i.lat(),e.longitude=i.lng()),e},getLabelPositionPoint:function(e){var n,i;if(void 0!==e)return e=/^([-\d\.]+)\s([-\d\.]+)$/.exec(e),n=parseFloat(e[1]),i=parseFloat(e[2]),null!=n&&null!=i?new google.maps.Point(n,i):void 0},createWindowOptions:function(o,t,a,u){var s;return null!=a&&null!=u&&null!=i?(s=n.extend({},u,{content:this.buildContent(t,u,a),position:null!=u.position?u.position:n.isObject(o)?o.getPosition():r(t.coords)}),null!=o&&null==(null!=s?s.pixelOffset:void 0)&&(null==s.boxClass||(s.pixelOffset={height:0,width:-2})),s):u?u:(e.error("infoWindow defaults not defined"),a?void 0:e.error("infoWindow content not defined"))},buildContent:function(e,n,o){var t,r;return null!=n.content?r=n.content:null!=i?(o=o.replace(/^\s+|\s+$/g,""),t=""===o?"":i(o)(e),t.length>0&&(r=t[0])):r=o,r},defaultDelay:50,isTrue:function(e){return t(e,!0,["true","TRUE",1,"y","Y","yes","YES"])},isFalse:o,isFalsy:function(e){return t(e,!1,[void 0,null])||o(e)},getCoords:r,validateCoords:s,equalCoords:function(e,n){return a(e)===a(n)&&u(e)===u(n)},validatePath:function(e){var i,o,t,r;if(o=0,n.isUndefined(e.type)){if(!Array.isArray(e)||e.length<2)return!1;for(;o<e.length;){if(!(n.isDefined(e[o].latitude)&&n.isDefined(e[o].longitude)||"function"==typeof e[o].lat&&"function"==typeof e[o].lng))return!1;o++}return!0}if(n.isUndefined(e.coordinates))return!1;if("Polygon"===e.type){if(e.coordinates[0].length<4)return!1;i=e.coordinates[0]}else if("MultiPolygon"===e.type){if(r={max:0,index:0},_.forEach(e.coordinates,function(e,n){if(e[0].length>this.max)return this.max=e[0].length,this.index=n},r),t=e.coordinates[r.index],i=t[0],i.length<4)return!1}else{if("LineString"!==e.type)return!1;if(e.coordinates.length<2)return!1;i=e.coordinates}for(;o<i.length;){if(2!==i[o].length)return!1;o++}return!0},convertPathPoints:function(e){var i,o,t,r,a;if(o=0,r=new google.maps.MVCArray,n.isUndefined(e.type))for(;o<e.length;)n.isDefined(e[o].latitude)&&n.isDefined(e[o].longitude)?t=new google.maps.LatLng(e[o].latitude,e[o].longitude):"function"==typeof e[o].lat&&"function"==typeof e[o].lng&&(t=e[o]),r.push(t),o++;else for("Polygon"===e.type?i=e.coordinates[0]:"MultiPolygon"===e.type?(a={max:0,index:0},_.forEach(e.coordinates,function(e,n){if(e[0].length>this.max)return this.max=e[0].length,this.index=n},a),i=e.coordinates[a.index][0]):"LineString"===e.type&&(i=e.coordinates);o<i.length;)r.push(new google.maps.LatLng(i[o][1],i[o][0])),o++;return r},getPath:function(e,n){var i;return null!=n&&_.isString(n)?(i=e,_.each(n.split("."),function(e){if(i)return i=i[e]}),i):n},validateBoundPoints:function(e){return!(n.isUndefined(e.sw.latitude)||n.isUndefined(e.sw.longitude)||n.isUndefined(e.ne.latitude)||n.isUndefined(e.ne.longitude))},convertBoundPoints:function(e){var n;return n=new google.maps.LatLngBounds(new google.maps.LatLng(e.sw.latitude,e.sw.longitude),new google.maps.LatLng(e.ne.latitude,e.ne.longitude))},fitMapBounds:function(e,n){return e.fitBounds(n)}}}])}.call(this),function(){n.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapEventsHelper",["uiGmapLogger",function(e){var i,o;return o=function(e){return n.isDefined(e.events)&&null!=e.events&&n.isObject(e.events)},i=function(e,n){return o(e)?e:o(n)?n:void 0},{setEvents:function(e,o,t,r){var a;if(a=i(o,t),null!=a)return _.compact(_.map(a.events,function(i,u){var s;if(r&&(s=_(r).includes(u)),a.events.hasOwnProperty(u)&&n.isFunction(a.events[u])&&!s)return google.maps.event.addListener(e,u,function(){return o.$evalAsync||(o.$evalAsync=function(){}),o.$evalAsync(i.apply(o,[e,u,t,arguments]))})}))},removeEvents:function(e){var n,i;if(e)for(n in e)i=e[n],i&&e.hasOwnProperty(n)&&google.maps.event.removeListener(i)}}}])}.call(this),function(){n.module("uiGmapgoogle-maps").directive("uiGmapStreetViewPanorama",["uiGmapGoogleMapApi","uiGmapLogger","uiGmapGmapUtil","uiGmapEventsHelper",function(e,i,o,t){var r;return r="uiGmapStreetViewPanorama",{restrict:"EMA",template:'<div class="angular-google-map-street-view-panorama"></div>',replace:!0,scope:{focalcoord:"=",radius:"=?",events:"=?",options:"=?",control:"=?",povoptions:"=?",imagestatus:"="},link:function(a,u,s){return e.then(function(e){return function(e){var s,l,d,p,g,c,m,f,v,h;return f=void 0,h=void 0,d=!1,c=void 0,m=null,v=null,s=function(){if(t.removeEvents(c),null!=f&&(f.unbind("position"),f.setVisible(!1)),null!=h)return null!=(null!=h?h.setVisible:void 0)&&h.setVisible(!1),h=void 0},g=function(e,i){var o;return o=google.maps.geometry.spherical.computeHeading(e,i),d=!0,a.radius=a.radius||50,v=n.extend({heading:o,zoom:1,pitch:0},a.povoptions||{}),m=m=n.extend({navigationControl:!1,addressControl:!1,linksControl:!1,position:e,pov:v,visible:!0},a.options||{}),d=!1},l=function(){var e;return a.focalcoord?a.radius?(s(),null==h&&(h=new google.maps.StreetViewService),a.events&&(c=t.setEvents(h,a,a)),e=o.getCoords(a.focalcoord),h.getPanoramaByLocation(e,a.radius,function(n,i){var o,t,r;if(null!=a.imagestatus&&(a.imagestatus=i),null!=(null!=(r=a.events)?r.image_status_changed:void 0)&&a.events.image_status_changed(h,"image_status_changed",a,i),"OK"===i)return t=n.location.latLng,g(t,e),o=u[0],f=new google.maps.StreetViewPanorama(o,m)})):void i.error(r+": needs a radius to set the camera view from its focal target."):void i.error(r+": focalCoord needs to be defined")},null!=a.control&&(a.control.getOptions=function(){return m},a.control.getPovOptions=function(){return v},a.control.getGObject=function(){return h},a.control.getGPano=function(){return f}),a.$watch("options",function(e,n){if(e!==n&&e!==m&&!d)return l()}),p=!0,a.$watch("focalcoord",function(e,n){if((e!==n||p)&&null!=e)return p=!1,l()}),a.$on("$destroy",function(){return s()})}}(this))}}}])}.call(this)}(window,angular);
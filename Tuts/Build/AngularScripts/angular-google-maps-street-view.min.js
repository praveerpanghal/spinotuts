!function(e,n,o){"use strict";(function(){n.module("uiGmapgoogle-maps.providers",["nemLogging"]),n.module("uiGmapgoogle-maps.wrapped",[]),n.module("uiGmapgoogle-maps.extensions",["uiGmapgoogle-maps.wrapped","uiGmapgoogle-maps.providers"]),n.module("uiGmapgoogle-maps.directives.api.utils",["uiGmapgoogle-maps.extensions"]),n.module("uiGmapgoogle-maps.directives.api.managers",[]),n.module("uiGmapgoogle-maps.directives.api.options",["uiGmapgoogle-maps.directives.api.utils"]),n.module("uiGmapgoogle-maps.directives.api.options.builders",[]),n.module("uiGmapgoogle-maps.directives.api.models.child",["uiGmapgoogle-maps.directives.api.utils","uiGmapgoogle-maps.directives.api.options","uiGmapgoogle-maps.directives.api.options.builders"]),n.module("uiGmapgoogle-maps.directives.api.models.parent",["uiGmapgoogle-maps.directives.api.managers","uiGmapgoogle-maps.directives.api.models.child","uiGmapgoogle-maps.providers"]),n.module("uiGmapgoogle-maps.directives.api",["uiGmapgoogle-maps.directives.api.models.parent"]),n.module("uiGmapgoogle-maps",["uiGmapgoogle-maps.directives.api","uiGmapgoogle-maps.providers"])}).call(this),n.module("uiGmapgoogle-maps.wrapped").service("uiGmapuuid",function(){function e(){}return e.generate=function(){var n=e._gri,o=e._ha;return o(n(32),8)+"-"+o(n(16),4)+"-"+o(16384|n(12),4)+"-"+o(32768|n(14),4)+"-"+o(n(48),12)},e._gri=function(e){return 0>e?NaN:30>=e?0|Math.random()*(1<<e):53>=e?(0|1073741824*Math.random())+1073741824*(0|Math.random()*(1<<e-30)):NaN},e._ha=function(e,n){for(var o=e.toString(16),i=n-o.length,t="0";i>0;i>>>=1,t+=t)1&i&&(o=t+o);return o},e}),function(){n.module("uiGmapgoogle-maps.providers").factory("uiGmapMapScriptLoader",["$q","uiGmapuuid",function(o,i){var t,r,a,u,s;return u=void 0,s=void 0,t=function(e){return e.china?"http://maps.google.cn/maps/api/js?":"auto"===e.transport?"//maps.googleapis.com/maps/api/js?":e.transport+"://maps.googleapis.com/maps/api/js?"},r=function(e){var n,o,r,a;return n=["transport","isGoogleMapsForWork","china","preventLoad"],e.isGoogleMapsForWork&&n.push("key"),o=_.map(_.omit(e,n),function(e,n){return n+"="+e}),u&&(a=document.getElementById(u),a.parentNode.removeChild(a)),o=o.join("&"),r=document.createElement("script"),r.id=u="ui_gmap_map_load_"+i.generate(),r.type="text/javascript",r.src=t(e)+o,document.body.appendChild(r)},a=function(){return n.isDefined(e.google)&&n.isDefined(e.google.maps)},{load:function(n){var i,t;return i=o.defer(),a()?(i.resolve(e.google.maps),i.promise):(t=n.callback="onGoogleMapsReady"+Math.round(1e3*Math.random()),e[t]=function(){e[t]=null,i.resolve(e.google.maps)},e.navigator.connection&&e.Connection&&e.navigator.connection.type===e.Connection.NONE&&!n.preventLoad?document.addEventListener("online",function(){return a()?void 0:r(n)}):n.preventLoad||r(n),s=n,s.randomizedFunctionName=t,i.promise)},manualLoad:function(){var n;return n=s,a()?e[n.randomizedFunctionName]?e[n.randomizedFunctionName]():void 0:r(n)}}}]).provider("uiGmapGoogleMapApi",function(){return this.options={transport:"https",isGoogleMapsForWork:!1,china:!1,v:"3",libraries:"",language:"en",preventLoad:!1},this.configure=function(e){n.extend(this.options,e)},this.$get=["uiGmapMapScriptLoader",function(e){return function(n){return n.load(e.options)}}(this)],this}).service("uiGmapGoogleMapApiManualLoader",["uiGmapMapScriptLoader",function(e){return{load:function(){e.manualLoad()}}}])}.call(this),function(){n.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapLogger",["nemSimpleLogger",function(e){return e.spawn()}])}.call(this),function(){n.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapGmapUtil",["uiGmapLogger","$compile",function(e,o){var i,t,r,a,u,s;return t=function(e,n,o){return e===n||-1!==o.indexOf(e)},i=function(e){return t(e,!1,["false","FALSE",0,"n","N","no","NO"])},a=function(e){return Array.isArray(e)&&2===e.length?e[1]:n.isDefined(e.type)&&"Point"===e.type?e.coordinates[1]:e.latitude},u=function(e){return Array.isArray(e)&&2===e.length?e[0]:n.isDefined(e.type)&&"Point"===e.type?e.coordinates[0]:e.longitude},r=function(e){return e?Array.isArray(e)&&2===e.length?new google.maps.LatLng(e[1],e[0]):n.isDefined(e.type)&&"Point"===e.type?new google.maps.LatLng(e.coordinates[1],e.coordinates[0]):new google.maps.LatLng(e.latitude,e.longitude):void 0},s=function(e){if(n.isUndefined(e))return!1;if(_.isArray(e)){if(2===e.length)return!0}else if(null!=e&&(null!=e?e.type:void 0)&&"Point"===e.type&&_.isArray(e.coordinates)&&2===e.coordinates.length)return!0;return!(!e||!n.isDefined((null!=e?e.latitude:void 0)&&n.isDefined(null!=e?e.longitude:void 0)))},{setCoordsFromEvent:function(e,o){return e?(Array.isArray(e)&&2===e.length?(e[1]=o.lat(),e[0]=o.lng()):n.isDefined(e.type)&&"Point"===e.type?(e.coordinates[1]=o.lat(),e.coordinates[0]=o.lng()):(e.latitude=o.lat(),e.longitude=o.lng()),e):void 0},getLabelPositionPoint:function(e){var n,o;if(void 0!==e)return e=/^([-\d\.]+)\s([-\d\.]+)$/.exec(e),n=parseFloat(e[1]),o=parseFloat(e[2]),null!=n&&null!=o?new google.maps.Point(n,o):void 0},createWindowOptions:function(i,t,a,u){var s;return null!=a&&null!=u&&null!=o?(s=n.extend({},u,{content:this.buildContent(t,u,a),position:null!=u.position?u.position:n.isObject(i)?i.getPosition():r(t.coords)}),null!=i&&null==(null!=s?s.pixelOffset:void 0)&&(null==s.boxClass||(s.pixelOffset={height:0,width:-2})),s):u?u:(e.error("infoWindow defaults not defined"),a?void 0:e.error("infoWindow content not defined"))},buildContent:function(e,n,i){var t,r;return null!=n.content?r=n.content:null!=o?(i=i.replace(/^\s+|\s+$/g,""),t=""===i?"":o(i)(e),t.length>0&&(r=t[0])):r=i,r},defaultDelay:50,isTrue:function(e){return t(e,!0,["true","TRUE",1,"y","Y","yes","YES"])},isFalse:i,isFalsy:function(e){return t(e,!1,[void 0,null])||i(e)},getCoords:r,validateCoords:s,equalCoords:function(e,n){return a(e)===a(n)&&u(e)===u(n)},validatePath:function(e){var o,i,t,r;if(i=0,n.isUndefined(e.type)){if(!Array.isArray(e)||e.length<2)return!1;for(;i<e.length;){if(!(n.isDefined(e[i].latitude)&&n.isDefined(e[i].longitude)||"function"==typeof e[i].lat&&"function"==typeof e[i].lng))return!1;i++}return!0}if(n.isUndefined(e.coordinates))return!1;if("Polygon"===e.type){if(e.coordinates[0].length<4)return!1;o=e.coordinates[0]}else if("MultiPolygon"===e.type){if(r={max:0,index:0},_.forEach(e.coordinates,function(e,n){return e[0].length>this.max?(this.max=e[0].length,this.index=n):void 0},r),t=e.coordinates[r.index],o=t[0],o.length<4)return!1}else{if("LineString"!==e.type)return!1;if(e.coordinates.length<2)return!1;o=e.coordinates}for(;i<o.length;){if(2!==o[i].length)return!1;i++}return!0},convertPathPoints:function(e){var o,i,t,r,a;if(i=0,r=new google.maps.MVCArray,n.isUndefined(e.type))for(;i<e.length;)n.isDefined(e[i].latitude)&&n.isDefined(e[i].longitude)?t=new google.maps.LatLng(e[i].latitude,e[i].longitude):"function"==typeof e[i].lat&&"function"==typeof e[i].lng&&(t=e[i]),r.push(t),i++;else for("Polygon"===e.type?o=e.coordinates[0]:"MultiPolygon"===e.type?(a={max:0,index:0},_.forEach(e.coordinates,function(e,n){return e[0].length>this.max?(this.max=e[0].length,this.index=n):void 0},a),o=e.coordinates[a.index][0]):"LineString"===e.type&&(o=e.coordinates);i<o.length;)r.push(new google.maps.LatLng(o[i][1],o[i][0])),i++;return r},getPath:function(e,n){var o;return null!=n&&_.isString(n)?(o=e,_.each(n.split("."),function(e){return o?o=o[e]:void 0}),o):n},validateBoundPoints:function(e){return!(n.isUndefined(e.sw.latitude)||n.isUndefined(e.sw.longitude)||n.isUndefined(e.ne.latitude)||n.isUndefined(e.ne.longitude))},convertBoundPoints:function(e){var n;return n=new google.maps.LatLngBounds(new google.maps.LatLng(e.sw.latitude,e.sw.longitude),new google.maps.LatLng(e.ne.latitude,e.ne.longitude))},fitMapBounds:function(e,n){return e.fitBounds(n)}}}])}.call(this),function(){n.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapEventsHelper",["uiGmapLogger",function(e){var o,i;return i=function(e){return n.isDefined(e.events)&&null!=e.events&&n.isObject(e.events)},o=function(e,n){return i(e)?e:i(n)?n:void 0},{setEvents:function(e,i,t,r){var a;return a=o(i,t),null!=a?_.compact(_.map(a.events,function(o,u){var s;return r&&(s=_(r).includes(u)),a.events.hasOwnProperty(u)&&n.isFunction(a.events[u])&&!s?google.maps.event.addListener(e,u,function(){return i.$evalAsync||(i.$evalAsync=function(){}),i.$evalAsync(o.apply(i,[e,u,t,arguments]))}):void 0})):void 0},removeEvents:function(e){var n,o;if(e)for(n in e)o=e[n],o&&e.hasOwnProperty(n)&&google.maps.event.removeListener(o)}}}])}.call(this),function(){n.module("uiGmapgoogle-maps").directive("uiGmapStreetViewPanorama",["uiGmapGoogleMapApi","uiGmapLogger","uiGmapGmapUtil","uiGmapEventsHelper",function(e,o,i,t){var r;return r="uiGmapStreetViewPanorama",{restrict:"EMA",template:'<div class="angular-google-map-street-view-panorama"></div>',replace:!0,scope:{focalcoord:"=",radius:"=?",events:"=?",options:"=?",control:"=?",povoptions:"=?",imagestatus:"="},link:function(a,u,s){return e.then(function(e){return function(e){var s,l,d,p,g,c,m,f,v,h;return f=void 0,h=void 0,d=!1,c=void 0,m=null,v=null,s=function(){return t.removeEvents(c),null!=f&&(f.unbind("position"),f.setVisible(!1)),null!=h?(null!=(null!=h?h.setVisible:void 0)&&h.setVisible(!1),h=void 0):void 0},g=function(e,o){var i;return i=google.maps.geometry.spherical.computeHeading(e,o),d=!0,a.radius=a.radius||50,v=n.extend({heading:i,zoom:1,pitch:0},a.povoptions||{}),m=m=n.extend({navigationControl:!1,addressControl:!1,linksControl:!1,position:e,pov:v,visible:!0},a.options||{}),d=!1},l=function(){var e;return a.focalcoord?a.radius?(s(),null==h&&(h=new google.maps.StreetViewService),a.events&&(c=t.setEvents(h,a,a)),e=i.getCoords(a.focalcoord),h.getPanoramaByLocation(e,a.radius,function(n,o){var i,t,r;return null!=a.imagestatus&&(a.imagestatus=o),null!=(null!=(r=a.events)?r.image_status_changed:void 0)&&a.events.image_status_changed(h,"image_status_changed",a,o),"OK"===o?(t=n.location.latLng,g(t,e),i=u[0],f=new google.maps.StreetViewPanorama(i,m)):void 0})):void o.error(r+": needs a radius to set the camera view from its focal target."):void o.error(r+": focalCoord needs to be defined")},null!=a.control&&(a.control.getOptions=function(){return m},a.control.getPovOptions=function(){return v},a.control.getGObject=function(){return h},a.control.getGPano=function(){return f}),a.$watch("options",function(e,n){return e===n||e===m||d?void 0:l()}),p=!0,a.$watch("focalcoord",function(e,n){return e===n&&!p||null==e?void 0:(p=!1,l())}),a.$on("$destroy",function(){return s()})}}(this))}}}])}.call(this)}(window,angular);